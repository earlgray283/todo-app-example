FROM --platform=linux/amd64 node:16

# ARG _REACT_APP_BACKEND_URL
# ARG _REACT_APP_API_KEY
# ARG _REACT_APP_AUTH_DOMAIN
# ARG _REACT_APP_PROJECT_ID
# ARG _REACT_APP_STORAGE_BUCKET
# ARG _REACT_APP_MESSAGING_SENDER_ID
# ARG _REACT_APP_APP_ID

# ENV REACT_APP_BACKEND_URL ${_REACT_APP_BACKEND_URL}
# ENV REACT_APP_API_KEY ${_REACT_APP_API_KEY}
# ENV REACT_APP_AUTH_DOMAIN ${_REACT_APP_AUTH_DOMAIN}
# ENV REACT_APP_PROJECT_ID ${_REACT_APP_PROJECT_ID}
# ENV REACT_APP_STORAGE_BUCKET ${_REACT_APP_STORAGE_BUCKET}
# ENV REACT_APP_MESSAGING_SENDER_ID ${_REACT_APP_MESSAGING_SENDER_ID}
# ENV REACT_APP_APP_ID ${_REACT_APP_APP_ID}

WORKDIR /work

RUN yarn global add serve

COPY package.json yarn.lock tsconfig.json /work/

RUN yarn install

COPY . .

RUN yarn build
EXPOSE 3000
ENTRYPOINT [ "serve", "-s", "build", "-p", "3000" ]
